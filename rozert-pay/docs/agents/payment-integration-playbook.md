# Регламент Интеграции Платежек

Этот документ задает детальные правила для задач по разработке платежных интеграций.

## Обязательный порядок работы

1. Создать или обновить дизайн-документ в `docs/integrations/<integration_name>/design.md`.
2. Обсудить документ с разработчиком и получить явное подтверждение.
3. Только после подтверждения начинать изменения кода.
4. После реализации обновить тот же дизайн/контекстный документ финальными решениями.

## Требования к дизайн-документу

Дизайн-документ должен содержать краткий операционный контекст без вставок большого объема кода:

- флоу `deposit`;
- флоу `withdraw`;
- ключевые допущения и ограничения интеграции;
- стратегию обработки callback/статусов;
- контекст, достаточный для продолжения работы в новом чате/сессии.

## Правила тестирования

- Тесты happy path для `deposit` и `withdraw` обязательны.
- Для HTTP-моков использовать `requests_mock`.
- Использовать минимум моков; внутреннюю бизнес-логику не мокать без строгой необходимости.
- Переиспользуемые моки выносить в фикстуры или контекстные менеджеры.

## Безопасность и секреты

- Никогда не хранить секреты в исходном коде.
- Не допускать утечки учетных данных/токенов в логах, тестах и документации.

## Стиль импортов

- Использовать абсолютные импорты. Исключения: __init__.py файлы.
